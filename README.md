# @codewithrajat/rm-ng-structure-pdf

[![npm version](https://img.shields.io/npm/v/@codewithrajat/rm-ng-structure-pdf.svg)](https://www.npmjs.com/package/@codewithrajat/rm-ng-structure-pdf)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
![Angular Support](https://img.shields.io/badge/angular-^14.0.0-brightgreen)
![Tree-shakable](https://img.shields.io/badge/tree--shaking-supported-success)
![TypeScript](https://img.shields.io/badge/types-TypeScript-blue)
[![Downloads](https://img.shields.io/npm/dm/@codewithrajat/rm-ng-structure-pdf.svg)](https://www.npmjs.com/package/@codewithrajat/rm-ng-structure-pdf)

---

`@codewithrajat/rm-ng-structure-pdf` is an Angular library with the primary goal of creating **truly structured, searchable, and accessible PDFs** directly from HTML content, moving beyond simple screenshot-to-PDF solutions.

> **Note:** 
>
> If you are looking for a stable, read-only PDF generator. please use the other  library: [`@codewithrajat/rm-ng-pdf-export`](https://www.npmjs.com/package/@codewithrajat/rm-ng-pdf-export). 
>This library, `@codewithrajat/rm-ng-structure-pdf`, is focused on the future of creating searchable, text-based documents.

---

### ‚úÖ Solves

-   **Client-Side PDF Generation**: Creates PDFs in the browser without a backend server.
-   **Searchable & Selectable Text**: Generates PDFs with real text, not images.
-   **Accessibility**: Produces documents that screen readers can understand.
-   **High-Fidelity Output**: Aims to preserve the structure and style of your HTML content.

### üë§ Ideal For

-   Angular developers needing to generate reports, dashboards, or invoices.
-   Applications requiring professional PDF exports with clean, selectable text.
-   Teams looking for a long-term solution for dynamic and accessible PDF generation.

---

## üöÄ Features


| Feature | Description | Status |
|---------|-------------|---------|
| üîç **Searchable Text** | Generate PDFs with selectable, searchable content | ‚úÖ |
| ‚ôø **Accessibility** | Screen reader compatible documents | ‚úÖ |
| üé® **Style Preservation** | Maintain HTML/CSS styling in PDF output | ‚úÖ |
| üìÑ **Smart Pagination** | Intelligent page breaking and content flow | üöß |
| ‚öôÔ∏è **Configurable** | Flexible page sizes, orientation, and metadata | ‚úÖ |
| üå≥ **Tree-Shakable** | Optimized bundle size | ‚úÖ |
| üöÄ **Client-Side** | No backend server required | ‚úÖ |
---

## üñºÔ∏è Live Demo

> [**See the implementation here**](https://stackblitz.com/edit/stackblitz-starters-lqnzau6p)

---

## üì¶ Installation

### Package Manager

Choose your preferred package manager:

```bash
# npm
npm install @codewithrajat/rm-ng-structure-pdf

# yarn
yarn add @codewithrajat/rm-ng-structure-pdf

# pnpm
pnpm add @codewithrajat/rm-ng-structure-pdf
```

### Required Dependencies

Install the required peer dependencies:

```bash
npm install jspdf html2canvas
```

| Dependency | Version | Purpose |
|------------|---------|---------|
| `@angular/core` | ^14.0.0+ | Angular framework |
| `jspdf` | ^2.5.1 | PDF generation engine |
| `html2canvas` | ^1.4.1 | HTML rendering |


---

## üß≠ Compatibility Matrix

| Angular Version | Compatible | Standalone Support |
|-----------------|------------|--------------------|
| 14              | ‚úÖ         | ‚úÖ                 |
| 15              | ‚úÖ         | ‚úÖ                 |
| 16              | ‚úÖ         | ‚úÖ                 |
| 17+             | ‚úÖ         | ‚úÖ                 |

---

## üöÄ Usage

### Basic Implementation

```typescript
import { Component, ElementRef, ViewChild } from '@angular/core';
import { PdfService, PdfOptions } from '@codewithrajat/rm-ng-structure-pdf';

@Component({
  selector: 'app-report',
  template: `
    <div #pdfContent class="report-content">
      <h1>My Report</h1>
      <p>This content will be converted to PDF</p>
      <!-- Your content here -->
    </div>
    <button (click)="exportToPdf()" class="export-btn">
      Export to PDF
    </button>
  `
})
export class ReportComponent {
  @ViewChild('pdfContent') contentRef!: ElementRef<HTMLDivElement>;

  constructor(private pdfService: PdfService) {}

  exportToPdf() {
    const options: PdfOptions = {
      fileName: 'report.pdf',
      pageSize: 'a4',
      orientation: 'portrait',
      title: 'My Report',
      author: 'My App'
    };

    this.pdfService.generatePaginatedPdf(
      this.contentRef.nativeElement, 
      options
    );
  }
}
```

### Service Registration

For standalone components:
```typescript
import { PdfService } from '@codewithrajat/rm-ng-structure-pdf';

@Component({
  providers: [PdfService], // Add this line
  // ... rest of component
})
```

For module-based apps:
```typescript
import { PdfService } from '@codewithrajat/rm-ng-structure-pdf';

@NgModule({
  providers: [PdfService], // Add this line
  // ... rest of module
})
```

---

## ‚öôÔ∏è Configuration

### PdfOptions Interface

```typescript
interface PdfOptions {
  fileName: string;           // Output file name
  pageSize: PageSize;         // Document page size
  orientation: Orientation;   // Page orientation
  title: string;             // PDF metadata title
  author: string;            // PDF metadata author
}

type PageSize = 'a4' | 'letter' | 'legal';
type Orientation = 'portrait' | 'landscape';
```

### Page Size Reference

| Size | Portrait (mm) | Landscape (mm) | Best For |
|------|---------------|----------------|----------|
| `a4` | 210 √ó 297 | 297 √ó 210 | International standard |
| `letter` | 215.9 √ó 279.4 | 279.4 √ó 215.9 | US standard |
| `legal` | 215.9 √ó 355.6 | 355.6 √ó 215.9 | Legal documents |

---


## ‚öôÔ∏è Advanced Configuration

The `PdfOptions` interface allows you to configure the PDF output. In the current version, all options are mandatory as there are no predefined defaults.

| Option        | Type                               | Description                              | Default |
|---------------|------------------------------------|------------------------------------------|---------|
| `fileName`    | `string`                           | The name of the file to be downloaded.   | (none)  |
| `pageSize`    | `'a4' | 'letter' | 'legal'`      | The page size for the PDF document.      | (none)  |
| `orientation` | `'portrait' | 'landscape'`        | The page orientation.                    | (none)  |
| `title`       | `string`                           | The title metadata for the PDF document. | (none)  |
| `author`      | `string`                           | The author metadata for the PDF document.| (none)  |


---


## üí° Examples

### Invoice Generation

```typescript
@Component({
  template: `
    <div #invoice class="invoice">
      <header class="invoice-header">
        <h1>Invoice #{{invoiceNumber}}</h1>
        <div class="company-info">...</div>
      </header>
      <table class="invoice-items">
        <!-- Invoice items -->
      </table>
      <footer class="invoice-footer">
        <div class="total">Total: {{total | currency}}</div>
      </footer>
    </div>
  `
})
export class InvoiceComponent {
  exportInvoice() {
    this.pdfService.generatePaginatedPdf(this.invoiceRef.nativeElement, {
      fileName: `invoice-${this.invoiceNumber}.pdf`,
      pageSize: 'letter',
      orientation: 'portrait',
      title: `Invoice ${this.invoiceNumber}`,
      author: 'Your Company'
    });
  }
}
```

### Report with Charts

```typescript
@Component({
  template: `
    <div #report class="report">
      <section class="charts">
        <canvas #chart1></canvas>
        <canvas #chart2></canvas>
      </section>
      <section class="data-tables">
        <!-- Tables and data -->
      </section>
    </div>
  `
})
export class DashboardComponent {
  async exportReport() {
    // Ensure charts are fully rendered
    await this.waitForChartsToRender();
    
    this.pdfService.generatePaginatedPdf(this.reportRef.nativeElement, {
      fileName: `dashboard-${new Date().toISOString().split('T')[0]}.pdf`,
      pageSize: 'a4',
      orientation: 'landscape', // Better for wide charts
      title: 'Dashboard Report',
      author: 'Analytics Team'
    });
  }
}
```

---


## üìù Best Practices

### üéØ Current Implementation (Image-Based)

> **Important**: The current version uses image slicing, which may cut content at page breaks.

#### Do's ‚úÖ

```html
<!-- Keep sections reasonably sized -->
<div class="section" style="margin-bottom: 20px;">
  <h2>Section Title</h2>
  <p>Content that fits comfortably in one page</p>
</div>

<!-- Use clear visual separators -->
<hr style="margin: 30px 0;" />

<!-- Design with export in mind -->
<div class="card" style="page-break-inside: avoid; margin-bottom: 15px;">
  <!-- Card content -->
</div>
```

#### Don'ts ‚ùå

```html
<!-- Avoid very tall single elements -->
<div style="height: 2000px;">
  <!-- This might get cut across pages -->
</div>

<!-- Don't rely on CSS page-break properties (yet) -->
<div style="page-break-before: always;">
  <!-- This won't work in current version -->
</div>
```

### üé® Styling Tips

```css
/* PDF-friendly styles */
.pdf-content {
  font-family: Arial, sans-serif;  /* Web-safe fonts */
  color: #333;                     /* Good contrast */
  background: white;               /* Avoid transparent backgrounds */
  padding: 20px;                   /* Consistent spacing */
  max-width: 800px;               /* Reasonable width */
}

/* Avoid these in PDF content */
.avoid-in-pdf {
  position: fixed;        /* Fixed positioning issues */
  transform: scale(0.8);  /* Transforms may not render correctly */
  filter: blur(2px);      /* Complex filters */
}
```

### üì± Responsive Considerations

```typescript
// Wait for content to load before exporting
async exportToPdf() {
  // For images
  await this.waitForImagesToLoad();
  
  // For dynamic content
  this.cdr.detectChanges();
  await new Promise(resolve => setTimeout(resolve, 100));
  
  this.pdfService.generatePaginatedPdf(/* ... */);
}
```

---

## üß≠ Compatibility

| Angular Version | Support | Standalone | Notes |
|-----------------|---------|------------|-------|
| 14.x | ‚úÖ Full | ‚úÖ Yes | Minimum required |
| 15.x | ‚úÖ Full | ‚úÖ Yes | Recommended |
| 16.x | ‚úÖ Full | ‚úÖ Yes | Recommended |
| 17.x | ‚úÖ Full | ‚úÖ Yes | Latest tested |
| 18.x+ | ‚úÖ Expected | ‚úÖ Yes | Should work |

### Browser Support

| Browser | Version | Support |
|---------|---------|---------|
| Chrome | 80+ | ‚úÖ Full |
| Firefox | 75+ | ‚úÖ Full |
| Safari | 13+ | ‚úÖ Full |
| Edge | 80+ | ‚úÖ Full |

---

## üéØ Smart Page Breaking (Vision vs. Reality)

The ultimate vision for this library is to provide intelligent page breaking that respects your content.

### ‚ú® The Goal:

-   **Content Boundary Detection**: Automatically avoid breaking content inside important elements.
-   **CSS `page-break` Support**: Respect CSS properties like `page-break-inside: avoid`.
-   **Visual Element Preservation**: Keep cards, images, and sections intact across pages.

### ‚ö†Ô∏è The Current Reality:

The current implementation uses an image-slicing technique. It renders the entire HTML element to one large image and then cuts it into page-sized chunks.

-   **This means content can be cut in half at a page break.**
-   The library **does not** currently support CSS `page-break` properties.

### üí° Best Practices (For Current Version)

1.  **Design for Export**: If possible, structure your content in sections that are less than a full page in height.
2.  **Manual Breaks**: Leave empty space or clear visual separators in your HTML where you would like a page to break.
3.  **Test Content**: Export PDFs with varying amounts of content to see where the breaks occur and adjust your layout accordingly.

---

## üå≥ Tree-Shaking and Optimization

-   The library is marked as `sideEffects: false` to support advanced tree-shaking.
-   The service-based API is inherently tree-shakable; it won\'t be included in your bundle if it\'s not imported and used.

---

## üõ†Ô∏è Contributing

We welcome contributions! See our [Contributing Guide](CONTRIBUTING.md) for details.

### Development Setup

```bash
git clone https://github.com/malikrajat/rm-ng-structure-pdf.git
cd rm-ng-structure-pdf
npm install
npm start  # Serves test app on localhost:4200
```

### Project Structure

```
projects/
‚îú‚îÄ‚îÄ @codewithrajat/rm-ng-structure-pdf/              # Library source code
‚îÇ   ‚îú‚îÄ‚îÄ src/lib/         
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pdf-service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pdf-options.types.ts
‚îÇ   ‚îî‚îÄ‚îÄ public-api.ts
‚îî‚îÄ‚îÄ pdf-structure/        # Test application
```

---

## üìñ Documentation

- [API Reference](docs/API.md)
- [Migration Guide](docs/MIGRATION.md)
- [Troubleshooting](docs/TROUBLESHOOTING.md)
- [Examples Repository](https://github.com/malikrajat/rm-ng-structure-pdf-examples)

---

## üêõ Issues & Support

- üêõ [Report Bug](https://github.com/malikrajat/rm-ng-structure-pdf/issues/new?template=bug_report.md)
- üí° [Request Feature](https://github.com/malikrajat/rm-ng-structure-pdf/issues/new?template=feature_request.md)
- üí¨ [Discussions](https://github.com/malikrajat/rm-ng-structure-pdf/discussions)
- üìß [Email Support](mailto:mr.rajatmalik@gmail.com?subject=rm-ng-structure-pdf%20Support)

---

## üìÑ License

MIT License - see [LICENSE](LICENSE) file for details.

---

## üë®‚Äçüíª Author

**Rajat Malik**
- üåê Website: [rajatmalik.dev](https://rajatmalik.dev)
- üìß Email: [mr.rajatmalik@gmail.com](mailto:mr.rajatmalik@gmail.com)
- üíº LinkedIn: [Connect with me](https://linkedin.com/in/errajatmalik)

---

## üôè Acknowledgments

Built with gratitude for the open-source community:

- **[jsPDF](https://github.com/parallax/jsPDF)** - Core PDF generation
- **[html2canvas](https://github.com/niklasvh/html2canvas)** - HTML to image rendering
- **[Angular Team](https://angular.io/)** - Amazing framework and ecosystem
- **Contributors** - Thank you for making this library better!

---

<div align="center">

**Built with ‚ù§Ô∏è for the Angular community**

‚≠ê Star this repo if it helped you! | üê¶ [Share on Twitter](https://twitter.com/intent/tweet?text=Check%20out%20this%20amazing%20Angular%20PDF%20library!&url=https://github.com/malikrajat/rm-ng-structure-pdf)

</div>